YUI.add("moodle-atto_fullscreen-button",function(o,t){var r="fullscreen";o.namespace("M.atto_fullscreen").Button=o.Base.create("button",o.M.editor_atto.EditorPlugin,[],{initializer:function(){var t,e;this.get("enablebutton")&&(t=this.addButton({icon:"e/fullscreen",callback:this._toggle}),e=this.get("host"),t.set("title",M.util.get_string("pluginname","atto_fullscreen")),this._background=o.Node.create('<div style="position: relative"></div>'),e.on("pluginsloaded",function(t,e){this._setFullscreen(e),this.toolbar.after("click",o.bind(this._fitToScreen,this)),o.on("windowresize",o.bind(this._fitToScreen,this))},this,t),o.one("body").on("focus",function(t,e,i){!e.getData(!1)||i.editor.ancestor(".editor_atto_wrap").contains(t.target)||t.target.hasClass("moodle-dialogue")||t.target.ancestor(".moodle-dialogue")||t.target.one(".moodle-dialogue")||(this.unHighlightButtons(r),this._setFullscreen(e))},this,t,e))},disableButtons:function(){return this},_toggle:function(t){t.preventDefault();t=this.buttons[r];this.get("host").editor.focus(),t.getData(!1)?(this.unHighlightButtons(r),this._setFullscreen(t)):(this.highlightButtons(r),this._setFullscreen(t,!0))},_fitToScreen:function(){var t,e,i;this.buttons[r].getData(!1)&&(i=(t=this.get("host")).editor.hasAttribute("hidden")||"none"===t.editor.getComputedStyle("display"),this._background.setStyles({left:-t.editor.get("winWidth")/2,height:t.editor.get("winHeight"),width:t.editor.get("winWidth")}),window.scrollTo(this._background.getX(),this._background.getY()),t._wrapper.setStyles({maxWidth:"100%",width:"100%",top:0}),t.editor.show(),e=parseFloat(t.editor.getComputedStyle("height"))+t.editor.get("winHeight")-parseFloat(t._wrapper.getComputedStyle("height")),t.editor.setStyles({height:e,maxHeight:e}),e=parseFloat(e)+20,t.textarea.setStyles({padding:t.editor.getComputedStyle("padding"),margin:t.editor.getComputedStyle("margin"),width:t.editor.getComputedStyle("width"),height:e,maxHeight:e,top:t.editor.getY()-t.toolbar.getY()}),t.textarea.setStyle("margin-bottom",parseFloat(t.editor.getComputedStyle("margin-bottom"))+20),t.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").setStyles({padding:t.textarea.getStyle("padding"),margin:t.textarea.getStyle("margin"),left:t.textarea.getStyle("left"),top:t.textarea.getStyle("top"),height:parseFloat(t.textarea.getStyle("height"))-20,maxHeight:parseFloat(t.textarea.getStyle("maxHeight"))-20,position:"fixed",width:t.textarea.getStyle("width")}),i)&&(!t.textarea.hasAttribute("hidden")&&"none"!==t.textarea.getComputedStyle("display")||(this._background.setStyles({padding:t._wrapper.getComputedStyle("padding"),margin:t._wrapper.getComputedStyle("margin"),height:t._wrapper.getComputedStyle("height"),width:t._wrapper.getComputedStyle("width")}),window.scrollTo(this._background.getX(),this._background.getY())),this.editor.hide())},_setFullscreen:function(t,e){var i=this.get("host");e?(o.one("body").setStyle("overflow","hidden"),this._editorStyle={minHeight:i.editor.getStyle("min-height"),height:i.editor.getStyle("height")},o.one("body").insertBefore(this._background,i._wrapper),i._wrapper.setStyles({position:"fixed",top:"0px",left:"0px",scroll:"auto"}),o.one("body").addClass("atto-fullscreen"),i.textarea.setStyles({position:"fixed",overflow:"auto",left:0}),i._wrapper.setStyles({left:0,position:"fixed"}),o.one(".editor_atto").setStyles({"z-index":999})):(o.one("body").setStyle("overflow","inherit"),this._background.remove(),this._editorStyle&&(i.editor.removeAttribute("style"),i.editor.setStyles(this._editorStyle),"none"===i.textarea.getComputedStyle("display")?(i.textarea.removeAttribute("style"),i.textarea.setStyle("display","none")):i.textarea.removeAttribute("style"),i.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").removeAttribute("style").setStyles(this._editorStyle)),i._wrapper.removeAttribute("style"),o.one("body").removeClass("atto-fullscreen"),i.textarea.setStyle("width",this.toolbar.getComputedStyle("width")),o.one(".editor_atto").setStyles({"z-index":"auto"})),t.setData(!1,!!e),this._fitToScreen()}},{ATTRS:{enablebutton:{value:!1}}})},"@VERSION@",{requires:["event-resize","moodle-editor_atto-plugin"]});