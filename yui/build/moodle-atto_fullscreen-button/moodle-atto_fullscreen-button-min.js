YUI.add("moodle-atto_fullscreen-button",function(t,e){var i="fullscreen";t.namespace("M.atto_fullscreen").Button=t.Base.create("button",t.M.editor_atto.EditorPlugin,[],{initializer:function(){if(this.get("enablebutton")){var e=this.addButton({icon:"e/fullscreen",callback:this._toggle}),o=this.get("host");e.set("title",M.util.get_string("pluginname","atto_fullscreen")),this._background=t.Node.create('<div style="position: relative"></div>'),o.on("pluginsloaded",function(e,i){this._setFullscreen(i),this.toolbar.after("click",t.bind(this._fitToScreen,this)),t.on("windowresize",t.bind(this._fitToScreen,this))},this,e),t.one("body").on("focus",function(t,e,o){!e.getData(!1)||o.editor.ancestor(".editor_atto_wrap").contains(t.target)||t.target.hasClass("moodle-dialogue")||t.target.ancestor(".moodle-dialogue")||t.target.one(".moodle-dialogue")||(this.unHighlightButtons(i),this._setFullscreen(e))},this,e,o)}},disableButtons:function(){return this},_toggle:function(t){t.preventDefault();var e=this.buttons[i];e.getData(!1)?(this.unHighlightButtons(i),this._setFullscreen(e)):(this.highlightButtons(i),this._setFullscreen(e,!0))},_fitToScreen:function(){if(this.buttons[i].getData(!1)){var t,e=this.get("host"),o=e.editor.hasAttribute("hidden")||"none"===e.editor.getComputedStyle("display");this._background.setStyles({left:-e.editor.get("winWidth")/2,height:e.editor.get("winHeight"),width:e.editor.get("winWidth")}),window.scrollTo(this._background.getX(),this._background.getY()),e._wrapper.setStyles({maxWidth:"100%",width:"100%",top:0}),e.editor.show(),t=parseFloat(e.editor.getComputedStyle("height"))+e.editor.get("winHeight")-parseFloat(e._wrapper.getComputedStyle("height")),e.editor.setStyles({height:t,maxHeight:t}),t=parseFloat(t)+20,e.textarea.setStyles({padding:e.editor.getComputedStyle("padding"),margin:e.editor.getComputedStyle("margin"),width:e.editor.getComputedStyle("width"),height:t,maxHeight:t,top:e.editor.getY()-e.toolbar.getY()}),e.textarea.setStyle("margin-bottom",parseFloat(e.editor.getComputedStyle("margin-bottom"))+20),e.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").setStyles({padding:e.textarea.getStyle("padding"),margin:e.textarea.getStyle("margin"),left:e.textarea.getStyle("left"),top:e.textarea.getStyle("top"),height:parseFloat(e.textarea.getStyle("height"))-20,maxHeight:parseFloat(e.textarea.getStyle("maxHeight"))-20,position:"fixed",width:e.textarea.getStyle("width")}),o&&((e.textarea.hasAttribute("hidden")||"none"===e.textarea.getComputedStyle("display"))&&(this._background.setStyles({padding:e._wrapper.getComputedStyle("padding"),margin:e._wrapper.getComputedStyle("margin"),height:e._wrapper.getComputedStyle("height"),width:e._wrapper.getComputedStyle("width")}),window.scrollTo(this._background.getX(),this._background.getY())),this.editor.hide())}},_setFullscreen:function(e,i){var o=this.get("host");i?(t.one("body").setStyle("overflow","hidden"),this._editorStyle={minHeight:o.editor.getStyle("min-height"),height:o.editor.getStyle("height")},t.one("body").insertBefore(this._background,o._wrapper),o._wrapper.setStyles({position:"fixed",top:"0px",left:"0px",scroll:"auto"}),t.one("body").addClass("atto-fullscreen"),o.textarea.setStyles({position:"fixed",overflow:"auto",left:0}),o._wrapper.setStyles({left:0,position:"fixed"}),t.one(".editor_atto").setStyles({"z-index":999})):(t.one("body").setStyle("overflow","inherit"),this._background.remove(),this._editorStyle&&(o.editor.removeAttribute("style"),o.editor.setStyles(this._editorStyle),"none"===o.textarea.getComputedStyle("display")?(o.textarea.removeAttribute("style"),o.textarea.setStyle("display","none")):o.textarea.removeAttribute("style"),o.toolbar.ancestor().ancestor().all(".CodeMirror-wrap").removeAttribute("style").setStyles(this._editorStyle)),o._wrapper.removeAttribute("style"),t.one("body").removeClass("atto-fullscreen"),o.textarea.setStyle("width",this.toolbar.getComputedStyle("width")),t.one(".editor_atto").setStyles({"z-index":"auto"})),e.setData(!1,!!i),this._fitToScreen()}},{ATTRS:{enablebutton:{value:!1}}})},"@VERSION@",{requires:["event-resize","moodle-editor_atto-plugin"]});